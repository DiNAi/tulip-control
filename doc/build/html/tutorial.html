

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial and Examples &mdash; rhtlp v0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="rhtlp v0.1.0 documentation" href="index.html" />
    <link rel="next" title="Receding horizon Temporal Logic Planning" href="rhtlp.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rhtlp.html" title="Receding horizon Temporal Logic Planning"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">rhtlp v0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-and-examples">
<h1>Tutorial and Examples<a class="headerlink" href="#tutorial-and-examples" title="Permalink to this headline">¶</a></h1>
<p>The rhtlp is developed for synthesis of embedded control systems,
allowing planning to be done in a receding horizon manner.
For more information regarding the theory behind this, please visit
our <a class="reference external" href="http://www.cds.caltech.edu/~utopcu/index.php/Receding_Horizon_Temporal_Logic_Planning_Toolbox_(RHTLP)">wiki</a>.</p>
<div class="section" id="synthesis-of-embedded-control-systems">
<h2>Synthesis of Embedded Control Systems<a class="headerlink" href="#synthesis-of-embedded-control-systems" title="Permalink to this headline">¶</a></h2>
<p>We consider a system that comprises the physical component, which we refer to as
the plant, and the (potentially dynamic and not a priori known) environment in
which the plant operates.
The system may contain both continuous (physical) and discrete (computational)
components.
In summary, the problem we are interested in consists of</p>
<blockquote>
<ul class="simple">
<li>discrete system state,</li>
<li>continuous system state,</li>
<li>(discrete) environment state, and</li>
<li>specification.</li>
</ul>
</blockquote>
<p>Here, <cite>discrete</cite> state refer to the state that can take only a finite number
of possible values while
<cite>continuous</cite> state refer to the state that can take an infinite number
of possible values, e.g., the position of the car.
The <cite>environment</cite> state is related to factors over which the system does not
have control such as the position of an obstacle and the outside temperature.
At any given time, the controller regulates the <cite>system</cite> (or <cite>controlled</cite>)
state such that the specification is satisfied, given the current value of the
environment variables and the previous system states.
We say that the specification is <cite>realizable</cite> if for any possible behavior
of the environment, such a controller exists, i.e., there exists a strategy
for the system to satisfy the specification.</p>
<p>Suppose the continuous state of the system evolves according to the
following discrete-time linear time-invariant state space model:
for <img class="math" src="_images/math/25c3702d367cd2c02c77ad61e439f3dac1799047.png" alt="t \in \{0,1,2,...\}"/></p>
<div class="math" id="equation-dynamics">
<p><span class="eqno">(1)</span><img src="_images/math/b1f10b70baff2f628915be231ca1541d0a25539b.png" alt="s[t+1]  &amp;=   As[t] + Bu[t] + Ed[t] \\
u[t]    &amp;\in U\\
d[t]    &amp;\in D\\
s[0]    &amp;\in S" /></p>
</div><p>where <img class="math" src="_images/math/317298ee9221eff0481453e9ac62815081b151cd.png" alt="S \subseteq \mathbb{R}^n"/> is the state space of the continuous
component of the system,
<img class="math" src="_images/math/fc6460508d02c81caf49307ac42384b43f4a89c7.png" alt="U \subseteq \mathbb{R}^m"/> is the set of admissible control inputs,
<img class="math" src="_images/math/b44f78abaffbddc7b2ac475bf6a95affb1a96dcc.png" alt="D \subseteq \mathbb{R}^p"/> is the set of exogenous disturbances and
<img class="math" src="_images/math/1c7a315650e2379262eb5bee0f997d7ab5a6e95a.png" alt="s[t], u[t], d[t]"/> are the continuous state, the control signal and
the exogenous disturbance, respectively, at time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>.</p>
<p>We consider the case where the sets <img class="math" src="_images/math/d1e2e2a0f2601b2ac74356133ba564a081a61d78.png" alt="S, U, D"/> are bounded polytopes.</p>
<p>Let <img class="math" src="_images/math/c3e77f8dac39bd44cff4ca15469c871bab27c02e.png" alt="\Pi"/> be a finite set of atomic propositions of system variables.
Each of the atomic propositions in <img class="math" src="_images/math/c3e77f8dac39bd44cff4ca15469c871bab27c02e.png" alt="\Pi"/> essentially captures the
states of interest.
We consider the specification of the form</p>
<div class="math" id="equation-spec">
<p><span class="eqno">(2)</span><img src="_images/math/1a70bc0795ec80a9f18a054288dfb11fda3c38a1.png" alt="\varphi = \big(\varphi_{init} \wedge \varphi_e) \implies \varphi_s." /></p>
</div><p>Here, the assumption <img class="math" src="_images/math/b61609b6700e21c53c4b382101cf000539ad2d22.png" alt="\varphi_{init}"/> on the initial condition of the system
is a propositional formula built from <img class="math" src="_images/math/1a5deef5cb28b0e3cbff3c3c17037341fdeb55cb.png" alt="\Pi."/>
The assumption <img class="math" src="_images/math/a083a57c95393bde438cc281148de64143326583.png" alt="\varphi_e"/> on the environment and the desired behavior
<img class="math" src="_images/math/8e4478eaa04cebf3657c2e00c0bef97ce62440d5.png" alt="\varphi_s"/> are LTL formulas built from <img class="math" src="_images/math/1a5deef5cb28b0e3cbff3c3c17037341fdeb55cb.png" alt="\Pi."/>
See our <a class="reference external" href="http://www.cds.caltech.edu/~utopcu/index.php/Receding_Horizon_Temporal_Logic_Planning_Toolbox_(RHTLP)">wiki</a> for more details on the form of <img class="math" src="_images/math/a1bd9c588c681f5241c603c770ef650ef4ecbe6e.png" alt="\varphi_e, \varphi_s"/>.</p>
<img alt="_images/ecssyn.png" src="_images/ecssyn.png" />
<p>As illustrated in the figure above, our approach to this embedded control
system synthesis consists of the following main steps:</p>
<blockquote>
<ol class="arabic simple">
<li><a class="reference internal" href="#ssec-prop-part"><em>Generate a proposition preserving partition of the continuous state space.</em></a></li>
<li><a class="reference internal" href="#ssec-disc"><em>Discretize the continuous state space based on the evolution of the continuous state.</em></a></li>
<li><a class="reference internal" href="#ssec-syn"><em>Digital design synthesis.</em></a></li>
</ol>
</blockquote>
<div class="section" id="proposition-preserving-partition-of-continuous-state-space">
<span id="ssec-prop-part"></span><h3>Proposition Preserving Partition of Continuous State Space<a class="headerlink" href="#proposition-preserving-partition-of-continuous-state-space" title="Permalink to this headline">¶</a></h3>
<p>Given the continuous state space <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> of the system and the set <img class="math" src="_images/math/4cacf873292b07ee905dcb1b5ddb682d0f11fafa.png" alt="\Pi_c"/> of
propositions on the continuous state of the system, we partition <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> into a finite
number of cells such that all the continuous states in each cell satisfy exactly the
same set of propositions in <img class="math" src="_images/math/4cacf873292b07ee905dcb1b5ddb682d0f11fafa.png" alt="\Pi_c"/>.</p>
<p>This can be done using the following function call:</p>
<blockquote>
<dl class="function">
<dt>
<tt class="descclassname">prop2part.</tt><tt class="descname">prop2part2</tt><big>(</big><em>state_space</em>, <em>cont_props_dict</em><big>)</big><a class="reference internal" href="_modules/prop2part.html#prop2part2"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Main function that takes a domain (state_space) and a list of propositions (cont_props), and
returns a proposition preserving partition of the state space</p>
</dd></dl>

</blockquote>
</div>
<div class="section" id="continuous-state-space-discretization">
<span id="ssec-disc"></span><h3>Continuous state space discretization<a class="headerlink" href="#continuous-state-space-discretization" title="Permalink to this headline">¶</a></h3>
<p>Given a propositional preserving partition of the continuous state space and
the evolution of the continuous state as in <a href="#equation-dynamics">(1)</a>,
we refine the partition based on the reachability relation between cells
and obtain a finite state abstraction of the evolution of the continuous state,
represented by a finite transition system.</p>
<p>This can be done using the following function call:</p>
</div>
<div class="section" id="digital-design-synthesis">
<span id="ssec-syn"></span><h3>Digital design synthesis<a class="headerlink" href="#digital-design-synthesis" title="Permalink to this headline">¶</a></h3>
<p>The continuous state space discretization generates a finite state abstraction
of the continuous state, represented by a finite transition system.
Each state in this finite transition system corresponds to a cell in the continuous
domain.
A transition <img class="math" src="_images/math/b973745a4e4aa10751e09d75093a0cdb499ad6e9.png" alt="c_i \to c_j"/> in this finite state system indicates that
from any continuous state <img class="math" src="_images/math/058418cc5858eeab7f1ceb92f70b1c00fe7fe5d6.png" alt="s_0"/> that belongs to cell <img class="math" src="_images/math/1e95be43c04d6869c67861aae1e3e69123fedd8c.png" alt="c_i"/>,
there exists a sequence of control inputs <img class="math" src="_images/math/ada5ca63358e53658cbc8abb13da29105c0ff2a2.png" alt="u_0, u_1, \ldots, u_{N-1}"/>
that takes the system to another continuous state <img class="math" src="_images/math/8f7bb52379015c473901c36dad1c1e3b7ade04a0.png" alt="s_{N}"/> in cell <img class="math" src="_images/math/88d143238ae2718841dfd3ec099cbea395db77a4.png" alt="c_j"/>.
Hence, under the assumption that the specification is stutter invariant,
we can describe the continuous dynamics by an LTL formula of the form</p>
<div class="math">
<p><img src="_images/math/d4fcc021d52b36d535d15869a9fcbe7ad4d78af6.png" alt="(v = c_i) \implies next(\bigvee_{j \text{ s.t. } c_i \to c_j} v = c_j)," /></p>
</div><p>where <img class="math" src="_images/math/a9f23bf124b6b2b2a993eb313c72e678664ac74a.png" alt="v"/> is a new discrete variable that describes in which cell
the continuous state is.</p>
<p>Since the partition is proposition preserving, all the continuous states that belong
to the same cell satisfy exactly the same set of propositions on the continuous
state. By the abuse of notation, we write <img class="math" src="_images/math/e7fd60e5129d117276dcebc9600e5632ea06251a.png" alt="c_j \models X_i"/> if all the continuous
states in cell <img class="math" src="_images/math/88d143238ae2718841dfd3ec099cbea395db77a4.png" alt="c_j"/> satisfy proposition <img class="math" src="_images/math/5f8e5cbb6204882df1cf17cfe4b308d485af8056.png" alt="X_i"/>.
Then, we can replace any proposition <img class="math" src="_images/math/5f8e5cbb6204882df1cf17cfe4b308d485af8056.png" alt="X_i"/> on the continuous state variables
by the formula <img class="math" src="_images/math/d6535b57faa547bb2d28ffc2008b060acb78e4a9.png" alt="\displaystyle{\bigvee_{j \text{ s.t. } c_j \models X_i} v = c_j}"/>.</p>
<p>Putting everything together, we now obtain a specification of the form in <a href="#equation-spec">(2)</a>.
We can then use the GR(1) Game implementation in <a class="reference external" href="http://jtlv.ysaar.net/">JTLV</a> to
automatically synthesize a planner that ensures the satisfaction of the specification,
taking into account all the possible behaviors of the environment.
This can be done using the following steps.</p>
<blockquote>
<ol class="arabic">
<li><p class="first">Generate input to JTLV</p>
<blockquote>
<dl class="function">
<dt>
<tt class="descclassname">jtlvint.</tt><tt class="descname">generateJTLVInput</tt><big>(</big><em>env_vars={}</em>, <em>sys_disc_vars={}</em>, <em>spec=</em><span class="optional">[</span><span class="optional">]</span>, <em>disc_props={}</em>, <em>disc_dynamics=&lt;prop2part.PropPreservingPartition instance at 0x233e0f8&gt;</em>, <em>smv_file='tmp.smv'</em>, <em>spc_file='tmp.spc'</em>, <em>file_exist_option='a'</em>, <em>verbose=0</em><big>)</big><a class="reference internal" href="_modules/jtlvint.html#generateJTLVInput"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate JTLV input files: smv_file and spc_file.</p>
<p>Input:</p>
<ul class="simple">
<li><cite>env_vars</cite>: a dictionary {str : str} or {str : list} whose keys are the names 
of environment variables and whose values are their possible values, e.g., 
boolean or {0, 2, ..., 5} or [0, 2, 3, 4, 5].</li>
<li><cite>sys_disc_vars</cite>: a dictionary {str : str} or {str : list} whose keys are the 
names of discrete system variables and whose values are their possible values.</li>
<li><cite>spec</cite>: a list of two strings that represents system specification of the form
assumption -&gt; guarantee; the first string is the assumption and the second 
string is the guarantee.</li>
<li><cite>disc_props</cite>: a dictionary {str : str} whose keys are the symbols for 
propositions on discrete variables and whose values are the actual propositions
on discrete variables.</li>
<li><cite>disc_dynamics</cite>: a PropPreservingPartition object that represents the 
transition system obtained from the discretization procedure.</li>
<li><cite>smv_file</cite>: a string that specifies the name of the resulting smv file.</li>
<li><cite>spc_file</cite>: a string that specifies the name of the resulting spc file.</li>
<li><cite>file_exist_option</cite>: a string that indicate what to do when the specified smv_file 
or spc_file exists. Possible values are: &#8216;a&#8217; (ask whether to replace or
create a new file), &#8216;r&#8217; (replace the existing file), &#8216;n&#8217; (create a new file).</li>
<li><cite>verbose</cite>: an integer that specifies the verbose level. If verbose is set to 0,
this function will not print anything on the screen.</li>
</ul>
</dd></dl>

</blockquote>
</li>
<li><p class="first">Synthesize the discrete planner</p>
<blockquote>
<dl class="function">
<dt>
<tt class="descclassname">jtlvint.</tt><tt class="descname">computeStrategy</tt><big>(</big><em>smv_file</em>, <em>spc_file</em>, <em>aut_file=''</em>, <em>heap_size='-Xmx128m'</em>, <em>priority_kind=3</em>, <em>init_option=1</em>, <em>file_exist_option='a'</em>, <em>verbose=0</em><big>)</big><a class="reference internal" href="_modules/jtlvint.html#computeStrategy"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute an automaton satisfying the spec in smv_file and spc_file and store in 
aut_file. Return the realizability of the spec.</p>
<p>Input:</p>
<ul>
<li><p class="first"><cite>smv_file</cite>: a string that specifies the name of the smv file.</p>
</li>
<li><p class="first"><cite>spc_file</cite>: a string that specifies the name of the spc file.</p>
</li>
<li><p class="first"><cite>aut_file</cite>: a string that specifies the name of the file containing the resulting 
automaton.</p>
</li>
<li><p class="first"><cite>heap_size</cite>: a string that specifies java heap size.</p>
</li>
<li><p class="first"><cite>priority_kind</cite>: a string of length 3 or an integer that specifies the type of 
priority used in extracting the automaton. Possible values of <cite>priority_kind</cite> are:</p>
<blockquote>
<ul class="simple">
<li>3 - &#8216;ZYX&#8217;</li>
<li>7 - &#8216;ZXY&#8217;</li>
<li>11 - &#8216;YZX&#8217;</li>
<li>15 - &#8216;YXZ&#8217;</li>
<li>19 - &#8216;XZY&#8217;</li>
<li>23 - &#8216;XYZ&#8217;</li>
</ul>
</blockquote>
<p>Here X means that the controller tries to disqualify one of the environment 
assumptions, 
Y means that the controller tries to advance with a finite path to somewhere, and
Z means that the controller tries to satisfy one of his guarantees.</p>
</li>
<li><p class="first"><cite>init_option</cite>: an integer in that specifies how to handle the initial state of 
the system. Possible values of <cite>init_option</cite> are</p>
<blockquote>
<ul class="simple">
<li>0 - The system has to be able to handle all the possible initial system
states specified on the guarantee side of the specification.</li>
<li>1 (default) - The system can choose its initial state, in response to the initial
environment state. For each initial environment state, the resulting
automaton contains exactly one initial system state, starting from which
the system can satisfy the specification.</li>
<li>2 - The system can choose its initial state, in response to the initial
environment state. For each initial environment state, the resulting
automaton contain all the possible initial system states, starting from which
the system can satisfy the specification.</li>
</ul>
</blockquote>
</li>
<li><p class="first"><cite>file_exist_option</cite>: a string that indicate what to do when the specified aut_file 
exists. Possible values are: &#8216;a&#8217; (ask whether to replace or create a new file), 
&#8216;r&#8217; (replace the existing file), &#8216;n&#8217; (create a new file).</p>
</li>
<li><p class="first"><cite>verbose</cite>: an integer that specifies the verbose level.</p>
</li>
</ul>
</dd></dl>

</blockquote>
</li>
<li><p class="first">Construct the automaton</p>
<blockquote>
<dl class="class">
<dt>
<em class="property">class </em><tt class="descclassname">automaton.</tt><tt class="descname">Automaton</tt><big>(</big><em>states_or_file=</em><span class="optional">[</span><span class="optional">]</span>, <em>varnames=</em><span class="optional">[</span><span class="optional">]</span>, <em>verbose=0</em><big>)</big><a class="reference internal" href="_modules/automaton.html#Automaton"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Automaton class for representing a finite state automaton.
An Automaton object contains the following field:</p>
<ul class="simple">
<li><cite>states</cite>: a list of AutomatonState objects.</li>
</ul>
<p>Automaton([states_or_file, varname, verbose]) constructs an Automaton object based
on the following input:</p>
<ul class="simple">
<li><cite>states_or_file</cite>: a string containing the name of the aut file to be loaded or
a list of AutomatonState objects to be assigned to the <cite>states</cite> of this 
Automaton object.</li>
<li><cite>varname</cite>: a list of all the variable names. If it is not empty and 
states_or_file is a string representing the name of the aut file to be loaded, 
then this function will also check whether the variables in aut_file are in 
varnames.</li>
</ul>
</dd></dl>

</blockquote>
</li>
</ol>
</blockquote>
<dl class="docutils">
<dt>Step 1 and 2 above can be combined using the following function:</dt>
<dd><dl class="first last function">
<dt>
<tt class="descclassname">jtlvint.</tt><tt class="descname">synthesize</tt><big>(</big><em>env_vars={}</em>, <em>sys_disc_vars={}</em>, <em>spec=''</em>, <em>disc_props={}</em>, <em>disc_dynamics=&lt;prop2part.PropPreservingPartition instance at 0x233eb70&gt;</em>, <em>smv_file='tmp.smv'</em>, <em>spc_file='tmp.spc'</em>, <em>aut_file=''</em>, <em>heap_size='-Xmx128m'</em>, <em>priority_kind=3</em>, <em>init_option=1</em>, <em>file_exist_option='a'</em>, <em>verbose=0</em><big>)</big><a class="reference internal" href="_modules/jtlvint.html#synthesize"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute an automaton satisfying <cite>spec</cite>. Return the realizability of <cite>spec</cite>.
If <cite>spec</cite> is realizable, the resulting automaton will be stored in the
<cite>aut_file</cite>. Otherwise, the counter examples will be stored.
This function essentially combines <tt class="docutils literal"><span class="pre">generateJTLVInput</span></tt> and <tt class="docutils literal"><span class="pre">computeStrategy</span></tt></p>
<p>Input:</p>
<ul class="simple">
<li><cite>env_vars</cite>: a dictionary {str : str} or {str : list} whose keys are the names 
of environment variables and whose values are their possible values, e.g., 
boolean or {0, 2, ..., 5} or [0, 2, 3, 4, 5].</li>
<li><cite>sys_disc_vars</cite>: a dictionary {str : str} or {str : list} whose keys are the 
names of discrete system variables and whose values are their possible values.</li>
<li><cite>spec</cite>: a list of two strings that represents system specification of the form
assumption -&gt; guarantee; the first string is the assumption and the second 
string is the guarantee.</li>
<li><cite>disc_props</cite>: a dictionary {str : str} whose keys are the symbols for 
propositions on discrete variables and whose values are the actual propositions
on discrete variables.</li>
<li><cite>disc_dynamics</cite>: a PropPreservingPartition object that represents the 
transition system obtained from the discretization procedure.</li>
<li><cite>smv_file</cite>: a string that specifies the name of the resulting smv file.</li>
<li><cite>spc_file</cite>: a string that specifies the name of the resulting spc file.</li>
<li><cite>aut_file</cite>: a string that specifies the name of the file containing the resulting 
automaton.</li>
<li><cite>heap_size</cite>: a string that specifies java heap size.</li>
<li><cite>priority_kind</cite>: a string of length 3 or an integer that specifies the type of 
priority used in extracting the automaton. See the documentation of the 
<tt class="docutils literal"><span class="pre">computeStrategy</span></tt> function for the possible values of <cite>priority_kind</cite>.</li>
<li><cite>init_option</cite>: an integer in that specifies how to handle the initial state of 
the system. See the documentation of the <tt class="docutils literal"><span class="pre">computeStrategy</span></tt> function for the 
possible values of <cite>init_option</cite>.</li>
<li><cite>file_exist_option</cite>: a string that indicate what to do when the specified smv_file 
or spc_file exists. Possible values are: &#8216;a&#8217; (ask whether to replace or
create a new file), &#8216;r&#8217; (replace the existing file), &#8216;n&#8217; (create a new file).</li>
<li><cite>verbose</cite>: an integer that specifies the verbose level. If verbose is set to 0,
this function will not print anything on the screen.</li>
</ul>
</dd></dl>

</dd>
</dl>
</div>
<div class="section" id="specification-file-and-parser">
<h3>Specification File and Parser<a class="headerlink" href="#specification-file-and-parser" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="example-1-robot-motion-planning-with-only-discrete-decisions">
<h3>Example 1: Robot Motion Planning with only Discrete Decisions<a class="headerlink" href="#example-1-robot-motion-planning-with-only-discrete-decisions" title="Permalink to this headline">¶</a></h3>
<p>This example is provided in examples/robot_discrete_simple.py.
It illustrates the use of the jtlvint module in synthesizing a planner
for a robot that only needs to make discrete decision.</p>
<img alt="_images/robot_discrete_simple.png" class="align-center" src="_images/robot_discrete_simple.png" />
<p>We consider the robot moving around the regions as shown in the above figure
while receiving externally triggered park signal.
The specification of the robot is</p>
<div class="math">
<p><img src="_images/math/85215bbd9909bf6eab7c19862eea6fb2ddf0b7db.png" alt="\varphi = \square \diamond(\neg park) \implies (\square \diamond(s \in C_5)
\wedge \square(park \implies \diamond(s \in C_0)))." /></p>
</div><p>We cannot, however, deal with this specification directly since it is not in the form of
GR[1].
An equivalent GR[1] specification of the above specification can be obtained
by introducing an auxiliary discretey system variable <img class="math" src="_images/math/690964dcdace4b821563dcd325aa63d28671294b.png" alt="X0reach,"/> initialized to
<cite>True</cite>. The transition relation of <img class="math" src="_images/math/690964dcdace4b821563dcd325aa63d28671294b.png" alt="X0reach,"/> is given by
<img class="math" src="_images/math/f8ee251715395c66d357f5331eeb4c7b9a51571e.png" alt="\square(\text{next}(X0reach) = ((s \in C_0 \vee X0reach) \wedge \neg park))."/></p>
<p>To automatically synthesize a planner for this robot, we first import the necessary modules.</p>
<div class="highlight-rst"><div class="highlight"><pre>from prop2part import Region, PropPreservingPartition
from jtlvint import *
from automaton import *
</pre></div>
</div>
<p>Specify the smv file, spc file and aut file.</p>
<div class="highlight-rst"><div class="highlight"><pre>testfile = &#39;robot_discrete_simple&#39;
path = os.path.abspath(os.path.dirname(sys.argv[0]))
smvfile = os.path.join(path, &#39;specs&#39;, testfile+&#39;.smv&#39;)
spcfile = os.path.join(path, &#39;specs&#39;, testfile+&#39;.spc&#39;)
autfile = os.path.join(path, &#39;specs&#39;, testfile+&#39;.aut&#39;)
</pre></div>
</div>
<p>Specify the environment variables.</p>
<div class="highlight-rst"><div class="highlight"><pre>env_vars = {&#39;park&#39; : &#39;boolean&#39;}
</pre></div>
</div>
<p>Specify the discrete system variable.</p>
<div class="highlight-rst"><div class="highlight"><pre>disc_sys_vars = {&#39;X0reach&#39; : &#39;boolean&#39;}
</pre></div>
</div>
<p>Specify the transition system representing the continuous dynamics.
First, we list the propositions on the continuous states.
Here, these propositions specify in which cell the robot is,
i.e., Xi means that the robot is in cell Ci.
Then, we specify the regions.
Note that the first argument of Region(poly, prop) should be a list of
polytopes. But since we are not dealing with the actual controller, we will
just fill it with a string (think of it as a name of the region).
The second argument of Region(poly, prop) is a list that specifies which
propositions in cont_props above is satisfied. As specified below, regioni
satisfies proposition Xi.
Finally, we specify the adjacency between regions.
disc_dynamics.adj[i][j] = 1 if starting from region j,
the robot can move to region i while only staying in the union of region i
and region j.</p>
<div class="highlight-rst"><div class="highlight"><pre>disc_dynamics = PropPreservingPartition(list_region=[], list_prop_symbol=[])
disc_dynamics.list_prop_symbol = [&#39;X0&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;X4&#39;, &#39;X5&#39;] 
disc_dynamics.num_prop = len(disc_dynamics.list_prop_symbol)
region0 = Region(&#39;C0&#39;, [1, 0, 0, 0, 0, 0])
region1 = Region(&#39;C1&#39;, [0, 1, 0, 0, 0, 0])
region2 = Region(&#39;C2&#39;, [0, 0, 1, 0, 0, 0])
region3 = Region(&#39;C3&#39;, [0, 0, 0, 1, 0, 0])
region4 = Region(&#39;C4&#39;, [0, 0, 0, 0, 1, 0])
region5 = Region(&#39;C5&#39;, [0, 0, 0, 0, 0, 1])
disc_dynamics.list_region = [region0, region1, region2, region3, region4, region5]
disc_dynamics.num_regions = len(disc_dynamics.list_region)
disc_dynamics.trans =   [[1, 1, 0, 1, 0, 0], \
                         [1, 1, 1, 0, 1, 0], \
                         [0, 1, 1, 0, 0, 1], \
                         [1, 0, 0, 1, 1, 0], \
                         [0, 1, 0, 1, 1, 1], \
                         [0, 0, 1, 0, 1, 1]]
</pre></div>
</div>
<p>Specification.</p>
<div class="highlight-rst"><div class="highlight"><pre>assumption = &#39;X0reach &amp; []&lt;&gt;(!park)&#39;
guarantee = &#39;[]&lt;&gt;X5&#39;
guarantee += &#39; &amp;\n\t[](next(X0reach) = ((X0 | X0reach) &amp; !park))&#39;
</pre></div>
</div>
<p>Generate input to JTLV.</p>
<div class="highlight-rst"><div class="highlight"><pre>newvarname = generateJTLVInput(env_vars, disc_sys_vars, [assumption, guarantee], \
                                   {}, disc_dynamics, smvfile, spcfile, 2)
</pre></div>
</div>
<p>Check realizability.</p>
<div class="highlight-rst"><div class="highlight"><pre>realizability = checkRealizability(smvfile, spcfile, autfile, &#39;-Xmx128m&#39;, 11)
</pre></div>
</div>
<p>Construct an automaton.</p>
<div class="highlight-rst"><div class="highlight"><pre>computeStrategy(smvfile, spcfile, autfile, &#39;-Xmx128m&#39;, 11, 3)
aut = Automaton(autfile, [], 3)
</pre></div>
</div>
</div>
</div>
<div class="section" id="receding-horizon-temporal-logic-planning">
<h2>Receding Horizon Temporal Logic Planning<a class="headerlink" href="#receding-horizon-temporal-logic-planning" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial and Examples</a><ul>
<li><a class="reference internal" href="#synthesis-of-embedded-control-systems">Synthesis of Embedded Control Systems</a><ul>
<li><a class="reference internal" href="#proposition-preserving-partition-of-continuous-state-space">Proposition Preserving Partition of Continuous State Space</a></li>
<li><a class="reference internal" href="#continuous-state-space-discretization">Continuous state space discretization</a></li>
<li><a class="reference internal" href="#digital-design-synthesis">Digital design synthesis</a></li>
<li><a class="reference internal" href="#specification-file-and-parser">Specification File and Parser</a></li>
<li><a class="reference internal" href="#example-1-robot-motion-planning-with-only-discrete-decisions">Example 1: Robot Motion Planning with only Discrete Decisions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#receding-horizon-temporal-logic-planning">Receding Horizon Temporal Logic Planning</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rhtlp.html"
                        title="next chapter">Receding horizon Temporal Logic Planning</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rhtlp.html" title="Receding horizon Temporal Logic Planning"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             >previous</a> |</li>
        <li><a href="index.html">rhtlp v0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Richard Murray, Necmiye Ozay, Ufuk Topcu, Nok Wongpiromsarn, Mumu Xu.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.1.
    </div>
  </body>
</html>